# Deploying to s4.fullstackaiautomation.com

## Overview

This Next.js dashboard is deployed to GitHub Pages at **`s4.fullstackaiautomation.com`** via the `gh-pages` branch.

**Repository:** https://github.com/fullstackaiautomation/s4dashboard
**Default Branch:** `main`
**Deployment Branch:** `gh-pages`
**GitHub Pages Config:** Build and deployment from `gh-pages` branch

---

## Quick Deployment Steps

### 1. Make Your Changes

Edit code in the `main` branch as usual:

```bash
cd "C:\Users\blkw\OneDrive\Documents\Github\Source 4 Industries\Source 4 Dashboard\web"
# Make your changes to src/ and other files
```

### 2. Build the Project

```bash
npm run build
```

This generates the static output in the `out/` directory, ready for GitHub Pages.

### 3. Commit and Push to Main

```bash
cd "C:\Users\blkw\OneDrive\Documents\Github\Source 4 Industries"
git add .
git commit -m "Fix CSS styling on live site - remove basePath for root domain deployment"
git push origin main
```

### 4. Deploy to gh-pages Branch

Push the built output to the `gh-pages` branch:

```bash
# From the web directory
cd "C:\Users\blkw\OneDrive\Documents\Github\Source 4 Industries\Source 4 Dashboard\web"

# Option A: Using git subtree (recommended)
git subtree push --prefix out origin gh-pages

# Option B: Manual push to gh-pages
# (Only if subtree fails)
# 1. Copy the 'out' directory contents
# 2. Switch to gh-pages branch
# 3. Replace files and push
```

### 5. Verify Deployment

Visit: **https://s4.fullstackaiautomation.com**

Changes typically appear within **30 seconds to 2 minutes** after pushing to `gh-pages`.

---

## Understanding the Deployment Flow

```
Local Development
    ↓
Source Code (main branch)
    ↓
npm run build → generates 'out/' directory (static files)
    ↓
Push to gh-pages branch
    ↓
GitHub Pages detects change
    ↓
Serves static files from https://s4.fullstackaiautomation.com
```

---

## Next.js Configuration for GitHub Pages

Your `next.config.ts` is configured for root domain deployment:

```typescript
const nextConfig: NextConfig = {
  output: "export",        // Static export (no basePath)
  basePath: "",            // Deployed at root domain
  assetPrefix: "",         // Assets served from root
  trailingSlash: true,
  images: {
    unoptimized: true,
  },
};
```

**Key points:**
- `output: "export"` - Generates static HTML/CSS/JS (required for GitHub Pages)
- `basePath: ""` - No subdirectory prefix (deployed at `s4.fullstackaiautomation.com`)
- `assetPrefix: ""` - CSS/JS loaded from root

---

## Troubleshooting

### "CSS not loading on live site"

**Cause:** Incorrect `basePath` or `assetPrefix` in `next.config.ts`

**Fix:** Ensure both are empty strings `""` since the site is at root domain:

```typescript
basePath: "",      // NOT "/s4dashboard" or similar
assetPrefix: "",   // NOT "/s4dashboard/" or similar
```

Then rebuild and redeploy:

```bash
npm run build
git subtree push --prefix out origin gh-pages
```

### "Changes not appearing on live site"

**Cause:** Forgot to push to `gh-pages` branch

**Fix:** Build and push the `out/` directory to `gh-pages`:

```bash
npm run build
git subtree push --prefix out origin gh-pages
```

### "Browser cache showing old version"

**Fix:** Hard refresh in your browser:
- Windows/Linux: `Ctrl + Shift + R`
- Mac: `Cmd + Shift + R`

Or open DevTools and disable cache while DevTools is open.

### "gh-pages branch doesn't exist"

**Fix:** Create it by pushing an initial build:

```bash
npm run build
git subtree push --prefix out origin gh-pages
```

GitHub will create the branch automatically.

---

## Environment Variables

Environment variables in `.env.local` are **NOT** included in production builds. If you need to use Supabase or other services, configure them at build time:

```bash
# In .env.local (not committed to git)
NEXT_PUBLIC_SUPABASE_URL=your-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-key
```

Then reference in your code:

```typescript
const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
```

**Note:** Only variables prefixed with `NEXT_PUBLIC_` are available in the browser.

---

## Git Workflow Summary

**Every deployment cycle:**

```bash
# 1. Make changes to source code
# (edit src/, components/, etc.)

# 2. Build the project
npm run build

# 3. Commit code to main
git add .
git commit -m "Your changes description"
git push origin main

# 4. Deploy built output to gh-pages
git subtree push --prefix out origin gh-pages

# 5. Verify at https://s4.fullstackaiautomation.com
```

---

## Important Notes

- ✅ The `out/` directory is generated by `npm run build` and contains static files
- ✅ GitHub Pages automatically serves `out/index.html` at `/`
- ✅ Always build before deploying (`npm run build` must run first)
- ❌ Do NOT manually edit files in the `gh-pages` branch
- ❌ Do NOT commit `out/` or `node_modules/` to the `main` branch (use `.gitignore`)

---

## DNS Configuration

Your domain `s4.fullstackaiautomation.com` is already configured to point to GitHub Pages via DNS CNAME records. No changes needed unless you move to a different hosting service.

---

## Questions?

Refer to:
- [Next.js Static Export Docs](https://nextjs.org/docs/app/building-your-application/deploying/static-exports)
- [GitHub Pages Docs](https://docs.github.com/en/pages/getting-started-with-github-pages)